<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Auto Bonau – Fahrzeuge</title>
  <style>
    :root { --sand:#d9c8a3; }
    body { font-family: -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; margin: 24px; color:#111; }
    .wrap { max-width: 1200px; margin: 0 auto; }
    h1 { font-size: 28px; margin: 0 0 8px; }
    .small { color:#555; margin: 0 0 16px; }
    .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 16px; }
    .card { border: 1px solid #e5e5e5; border-radius: 16px; overflow: hidden; background:#fff; box-shadow: 0 2px 6px rgba(0,0,0,.04); }
    .img { width: 100%; height: 180px; background:#f5f5f5; object-fit: cover; display:block; }
    .content { padding: 14px; }
    .title { margin: 0 0 6px; font-weight: 600; }
    .meta { color: #666; font-size: 12px; }
    .price { font-weight: 700; margin: 10px 0; }
    .btn { display:inline-block; padding:10px 14px; border-radius: 999px; background: var(--sand); color: #fff; text-decoration: none; }
    .err { color:#b00020; white-space: pre-wrap; margin-top: 10px; }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Unsere Autos</h1>
    <p class="small">Diese Seite laedt autos.json relativ zum aktuellen Pfad.</p>
    <div id="status" class="small">Lade Daten…</div>
    <div id="grid" class="grid"></div>
    <pre id="error" class="err"></pre>
  </div>

  <script>
    function card(car) {
      const img = Array.isArray(car.images) && car.images.length ? car.images[0] : null;
      return `
        <div class="card">
          ${img ? `<img class="img" src="${img}" alt="">` : ''}
          <div class="content">
            <p class="title">${car.brand || car.make || ''} ${car.model || ''} ${car.trim ? '– ' + car.trim : ''}</p>
            <div class="meta">${car.first_registration || ''} • ${car.mileage_km != null ? (car.mileage_km.toLocaleString('de-CH') + ' km') : ''}</div>
            <div class="price">${car.price_chf != null ? (new Intl.NumberFormat('de-CH', { style: 'currency', currency: 'CHF' }).format(car.price_chf)) : ''}</div>
            <a class="btn" href="#">Anfrage</a>
          </div>
        </div>`;
    }

    async function load() {
      const status = document.getElementById('status');
      const grid = document.getElementById('grid');
      const error = document.getElementById('error');
      try {
        const res = await fetch('./autos.json', { cache: 'no-store' });
        if (!res.ok) throw new Error(`HTTP ${res.status} – ${res.statusText}`);
        const data = await res.json();
        status.textContent = `Gefundene Fahrzeuge: ${data.length}`;
        grid.innerHTML = data.map(card).join('');
      } catch (e) {
        status.textContent = 'Fehler beim Laden.';
        error.textContent = String(e) + '\nHinweis: Liegt autos.json im selben Ordner wie index.html?';
        console.error(e);
      }
    }

    load();
  </script>
</body>
</html>
